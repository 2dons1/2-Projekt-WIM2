<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>2.Projekt</title>
</head>
<style>
  table, th, td {
    border:1px solid black;
  }
</style>
<body>
      <% if(sigurnost){ %>
        <button id="security" onclick="myFunction()" class="button" style="background-color: green; border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;">Stranica je sigurna</button>
    <% } %>
    <% if(!sigurnost){ %>
        <button id="security" onclick="myFunction()" style="background-color: red; border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;">Stranica nije sigurna</button>
    <% } %>

    <br>
    <a href="/">Home</a><br>

    <h1> 2. Projekt iz "Napredni razvoj programske potpore za web" </h1>
    <h2> SQL umetanje (SQL Injection) </h2>

      <form id="movie_form" method="POST" action="/sql">
        <p>Pronadi film prema rijeci iz naziva!</p>
        
        <!-- <legend>Odaberi razinu sigurnosti?</legend>
        <input type="radio" name="security" value="nesigurno" checked>Nesigurno<br>
        <input type="radio" name="security" value="sigurno">Sigurno<br> !-->

        <input type="text" name="movie_name">
        <input type="submit" value="Pronadi Flimove!">
      </form>

      <br>
      <hr>
      <% if(valid){ %>
      <table style="width:100%">
        <tr>
          <th>Id</th>
          <th>Name</th>
          <th>Genre</th>
          <th>Director</th>
          <th>Year</th>
        </tr>
        <% for(var i=0; i < movies.length; i++) { %>
          <tr>
            <td><%= movies[i]["id"] %></td>
            <td><%= movies[i]["name"] %></td>
            <td><%= movies[i]["genre"] %></td>
            <td><%= movies[i]["director"] %></td>
            <td><%= movies[i]["year"] %></td>
          </tr>
       <% } %>
      </table>
      <% } %>
      
      <script>
        async function myFunction() {
          const options = {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              }
          }
          const response = await fetch('/change-security', options);
          if(document.getElementById("security").innerHTML == "Stranica je sigurna"){
              document.getElementById("security").innerHTML = "Stranica nije sigurna";
              document.getElementById("security").style.backgroundColor = "red";
          }
          else{
              document.getElementById("security").innerHTML = "Stranica je sigurna";
              document.getElementById("security").style.backgroundColor = "green";
          }
        }
    </script>
</body>
</html>

